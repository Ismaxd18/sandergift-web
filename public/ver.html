<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SanDerGift | Una Rosa para Ti</title>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    <style>
        body { background: #050505; color: white; font-family: 'Outfit', sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }
        .flower { position: relative; }
        .petal { width: 50px; height: 50px; background: #ff0040; border-radius: 50% 50% 0 50%; position: absolute; transform: rotate(-45deg); box-shadow: 0 0 20px #ff0040; }
        /* Animaci√≥n simple de rosa */
        .stem { width: 8px; height: 150px; background: #006400; margin-top: 40px; border-radius: 5px; }
        .container { text-align: center; z-index: 10; background: rgba(0,0,0,0.6); padding: 20px; border-radius: 20px; backdrop-filter: blur(10px); }
        h1 { color: #ff0040; text-shadow: 0 0 10px #ff0040; }
        #expired { display: none; color: #ff3366; }
    </style>
</head>
<body>
    <div id="loader">Cargando tu detalle... üåπ</div>

    <div id="content" style="display:none;">
        <div class="flower">
            <div class="petal"></div>
            <div class="stem"></div>
        </div>
        <div class="container">
            <h1 id="destinatario"></h1>
            <p id="mensaje"></p>
            <small id="firma"></small>
        </div>
    </div>

    <div id="expired" class="container">
        <h1>‚è≥ Detalle Expirado</h1>
        <p>Este regalo de 24 horas ha vencido.</p>
        <button onclick="location.href='https://sandergift.web.app'">Crear uno nuevo</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDjx9vI4LNL9laJ104euQnQSudx2jfQTVs",
            authDomain: "sandergift.firebaseapp.com",
            databaseURL: "https://sandergift-default-rtdb.firebaseio.com",
            projectId: "sandergift"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const urlParams = new URLSearchParams(window.location.search);
        const giftId = urlParams.get('id');

        if(giftId) {
            db.ref('regalos/' + giftId).once('value', (snapshot) => {
                const data = snapshot.val();
                document.getElementById('loader').style.display = 'none';
                if(data) {
                    const ahora = Date.now();
                    const limite = 24 * 60 * 60 * 1000; // 24h
                    if(ahora - data.timestamp > limite) {
                        document.getElementById('expired').style.display = 'block';
                    } else {
                        document.getElementById('content').style.display = 'block';
                        document.getElementById('destinatario').innerText = "Para: " + data.nombre;
                        document.getElementById('mensaje').innerText = data.mensaje;
                        document.getElementById('firma').innerText = "De: " + data.remitente;
                    }
                }
            });
        }
    </script>
</body>
</html>
